{
  "version": 3,
  "sources": ["../s3-helper.ts"],
  "sourcesContent": ["import { S3Client, PutObjectCommand } from \"@aws-sdk/client-s3\";\r\nimport { Stream } from \"stream\";\r\n\r\nconst s3 = new S3Client({ region: \"us-east-1\" }); // Change to your AWS region\r\n\r\nasync function streamToBuffer(stream: Stream): Promise<Buffer> {\r\n  const chunks: Uint8Array[] = [];\r\n  return new Promise((resolve, reject) => {\r\n    stream.on(\"data\", (chunk) => chunks.push(chunk));\r\n    stream.on(\"end\", () => resolve(Buffer.concat(chunks)));\r\n    stream.on(\"error\", reject);\r\n  });\r\n}\r\n\r\nexport async function uploadFileToS3(file: Stream, fileName: string, s3BucketName: string): Promise<string> {\r\n  console.log(`Will upload to s3!`);\r\n\r\n  console.log(`Filename: ${fileName}, bucketname: ${s3BucketName}`)\r\n  const buffer = await streamToBuffer(file);\r\n  \r\n  const basePath = \"public-images/recipes\";\r\n  try {\r\n    await s3.send(new PutObjectCommand({\r\n      Bucket: s3BucketName,\r\n      Key: `basePath/${fileName}`,\r\n      Body: buffer,\r\n      ContentType: \"image/jpeg\", // Change dynamically if needed\r\n      ACL: \"public-read\"\r\n    }));\r\n  } catch(er) {\r\n    console.error(`Eror saving to s3: ${JSON.stringify(er)}`);\r\n  }\r\n\r\n  return `https://${s3BucketName}.s3.ca-central-1.amazonaws.com/${basePath}/${fileName}`;\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAA2C;AAG3C,IAAM,KAAK,IAAI,0BAAS,EAAE,QAAQ,YAAY,CAAC;AAE/C,eAAe,eAAe,QAAiC;AAC7D,QAAM,SAAuB,CAAC;AAC9B,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,WAAO,GAAG,QAAQ,CAAC,UAAU,OAAO,KAAK,KAAK,CAAC;AAC/C,WAAO,GAAG,OAAO,MAAM,QAAQ,OAAO,OAAO,MAAM,CAAC,CAAC;AACrD,WAAO,GAAG,SAAS,MAAM;AAAA,EAC3B,CAAC;AACH;AAEA,eAAsB,eAAe,MAAc,UAAkB,cAAuC;AAC1G,UAAQ,IAAI,oBAAoB;AAEhC,UAAQ,IAAI,aAAa,QAAQ,iBAAiB,YAAY,EAAE;AAChE,QAAM,SAAS,MAAM,eAAe,IAAI;AAExC,QAAM,WAAW;AACjB,MAAI;AACF,UAAM,GAAG,KAAK,IAAI,kCAAiB;AAAA,MACjC,QAAQ;AAAA,MACR,KAAK,YAAY,QAAQ;AAAA,MACzB,MAAM;AAAA,MACN,aAAa;AAAA;AAAA,MACb,KAAK;AAAA,IACP,CAAC,CAAC;AAAA,EACJ,SAAQ,IAAI;AACV,YAAQ,MAAM,sBAAsB,KAAK,UAAU,EAAE,CAAC,EAAE;AAAA,EAC1D;AAEA,SAAO,WAAW,YAAY,kCAAkC,QAAQ,IAAI,QAAQ;AACtF;",
  "names": []
}
